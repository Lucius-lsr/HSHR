# -*- coding: utf-8 -*-
"""
@Time    : 2022/3/1 16:16
@Author  : Lucius
@FileName: ssl_epoch.py
@Software: PyCharm
"""

import re

import matplotlib
import matplotlib.pyplot as plt
import numpy as np

loss_s = '''
5.3466278926987725
#5.783461361449229
#5.455913025868964
#4.857482163614817
#4.26951312587272
#3.709573120013621
#3.1913491794965925
#2.72708545227396
#2.3280216002356413
#1.9970327588767487
#1.7335292219576253
#1.5324685352420375
#1.3847337551246401
#1.283204074359048
#1.2115174251444198
#1.1670545131912058
#1.1413060769236465
#1.1252560472596285
#1.1142037637632896
#1.1032573874719542
'''
loss = re.findall(r"\d+\.?\d*", loss_s)
loss = [float(l) for l in loss]

y1 = [0.95239278, 0.95647065, 0.95934053, 0.96078144, 0.96005687, 0.96221,
      0.9614889, 0.96317378, 0.96387907, 0.96365438, 0.96292222, 0.96340347,
      0.96317249, 0.96315861, 0.96317596, 0.96363856, 0.96171988, 0.96268301,
      0.96316144, 0.96339718]

y1_s = [0.00560735, 0.00438185, 0.00533966, 0.00287247, 0.0049078, 0.00499056,
        0.00406701, 0.00429678, 0.00434385, 0.0038184, 0.00596184, 0.00491446,
        0.00467303, 0.0059755, 0.0044429, 0.00463469, 0.00338252, 0.00387088,
        0.00389183, 0.00339453]

# y1 = [0.95694689, 0.9543067, 0.95622514, 0.95814577, 0.96030995, 0.9641278,
#       0.96316402, 0.96342122, 0.96436289, 0.96219895]
# y1_s = [0.00576388, 0.00629302, 0.0047946, 0.00579154, 0.0067761, 0.00535816,
#         0.00480509, 0.00303792, 0.00249698, 0.00382419]
y1 = [100 * y for y in y1]
y1_s = [100 * y for y in y1_s]

y2 = [0.9347695,  0.93927822, 0.94228939, 0.94234167, 0.94302507, 0.94399465,
 0.94370708, 0.94487079, 0.94553849, 0.94636269, 0.94737103, 0.94780583,
 0.94774554, 0.94931892, 0.94925643, 0.94847598, 0.94734741, 0.94831015,
 0.94957742, 0.95004667]
y2_s = [0.00357811, 0.00254232, 0.00225601, 0.00181641, 0.00191477, 0.00137086,
 0.00202355, 0.00231062, 0.00197012, 0.00194786, 0.00253998, 0.00270727,
 0.00352826, 0.00254789, 0.00213765, 0.00253039, 0.00190176, 0.00167095,
 0.00216911, 0.00184115]

# y2 = [0.90624728, 0.90858906, 0.90976286, 0.91307751, 0.91354589, 0.91291097,
#       0.91446098, 0.91487531, 0.91543501, 0.91463667]
# y2_s = [0.00313884, 0.00231232, 0.0019974, 0.00211698, 0.00279318, 0.00399131,
#         0.00278829, 0.00297647, 0.00288914, 0.0044442]
y2 = [100 * y for y in y2]
y2_s = [100 * y for y in y2_s]

y3 = [0.90805217, 0.91011122, 0.90986004, 0.91234201, 0.91433344, 0.91488481,
 0.91473947, 0.91486293, 0.91474362, 0.91710559, 0.91744728, 0.91783741,
 0.91564353, 0.91717109, 0.91687414, 0.91643794, 0.91600743, 0.91612647,
 0.91612527, 0.9176766 ]
y3_s = [0.00514377, 0.00368336, 0.00254597, 0.00321426, 0.00232511, 0.00304881,
 0.00250555, 0.00340022, 0.00300231, 0.00390834, 0.00202032, 0.00270731,
 0.00191044, 0.00239628, 0.00276826, 0.00258896, 0.00311783, 0.00342082,
 0.00383627, 0.00479253]

# y3 = [0.93420507, 0.93843796, 0.93954583, 0.94239996, 0.94406942, 0.9424729,
#       0.94321093, 0.94292478, 0.94450199, 0.94466287]
# y3_s = [0.00367771, 0.00310782, 0.0026861, 0.00239653, 0.00226967, 0.0020385,
#         0.00188587, 0.00209769, 0.00265517, 0.00368703]
y3 = [100 * y for y in y3]
y3_s = [100 * y for y in y3_s]

r = 20
x = [i for i in range(r)]

title = 'Performance of HSHR During SSL Procedure'

# paint
# set style
plt.rc('font', family="Arial")
matplotlib.rcParams['pdf.fonttype'] = 42
matplotlib.rcParams['ps.fonttype'] = 42
plt.figure(figsize=(15, 6))

# plt.xlim(xmax=x_list[-1]*1.2, xmin=0)
plt.ylim(ymax=98, ymin=90)

fontsize = 25
plt.grid(linestyle='-.', linewidth=1)
ax = plt.gca()
ax.spines['bottom'].set_linewidth(2)
ax.spines['left'].set_linewidth(2)
ax.spines['right'].set_linewidth(2)
ax.spines['top'].set_linewidth(2)

plt.plot(x, y1[:r], '-o', ms=10, label='Hematopoietic', linewidth=4)
plt.plot(x, y2[:r], '-o', ms=10, label='Liver/PB', linewidth=4)
plt.plot(x, y3[:r], '-o', ms=10, label='Endocrine', linewidth=4)

plt.fill_between(range(r),
                 [m - s for m, s in zip(y1, y1_s)][:r],
                 [m + s for m, s in zip(y1, y1_s)][:r],
                 color='b',
                 alpha=0.2)
plt.fill_between(range(r),
                 [m - s for m, s in zip(y2, y2_s)][:r],
                 [m + s for m, s in zip(y2, y2_s)][:r],
                 color='orange',
                 alpha=0.4)
plt.fill_between(range(r),
                 [m - s for m, s in zip(y3, y3_s)][:r],
                 [m + s for m, s in zip(y3, y3_s)][:r],
                 color='green',
                 alpha=0.2)

plt.xlabel('Epoch', fontsize=30)
plt.xticks(x, fontsize=fontsize)
plt.ylabel('mMV@5(%)', fontsize=30)
plt.legend(fontsize=15, loc="upper left")
plt.yticks(fontsize=fontsize)

ax2 = plt.twinx()  # this is the important function
ax2.plot(loss, color='grey', linewidth=3)
ax2.set_ylabel('Loss', fontsize=fontsize)

plt.yticks(fontsize=fontsize)
plt.title(title, fontsize=30)

plt.tight_layout()
# plt.show()
plt.savefig('/Users/lishengrui/Desktop/prepared paper/fig5/{}.pdf'.format(title.replace('/', '_')), format='pdf', dpi=300, pad_inches=0)
